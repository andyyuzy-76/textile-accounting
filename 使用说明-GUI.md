# 🏠 家纺四件套记账系统 - 图形界面版

## ✨ 功能特点

- 🎨 **图形化界面** - 直观的操作界面，无需命令行
- ⚡ **实时录入** - 输入数据即时显示，自动计算金额
- 📊 **实时统计** - 今日数据实时更新
- 💾 **自动保存** - 数据自动保存，无需手动操作
- 📥 **导入导出** - 支持 CSV 导入导出

## 🚀 快速开始

### 运行程序

双击运行：`记账系统-GUI.bat`

或命令行：
```bash
cd %USERPROFILE%\.accounting-tool
python accounting_gui.py
```

## 📋 界面说明

### 左侧 - 录入区

#### 📝 录入新记录
1. **日期** - 默认今天，可修改
2. **数量（套）** - 输入货品数量
3. **单价（元）** - 输入每套价格
4. **总金额** - 自动计算显示
5. **备注** - 输入客户名、规格等信息

#### 快捷操作
- **今天按钮** - 快速设置日期为今天
- **添加记录(Enter)** - 保存记录
- **清空表单** - 清空输入框重新录入

#### ⌨️ 键盘快捷键
- **回车键快速跳转**：
  - 在"数量"框按回车 → 自动跳到"单价"框
  - 在"单价"框按回车 → 自动跳到"备注"框
  - 在"备注"框按回车 → 自动保存记录
- **Ctrl + Enter**：在备注框中换行（多行备注）
- **F5**：刷新显示

**💡 快速录入流程**：
```
输入数量 → 按回车 → 输入单价 → 按回车 → 输入备注 → 按回车（保存）
```
全程无需鼠标，快速连续录入！

#### 📊 今日统计
实时显示今天的汇总数据：
- 总数量
- 总金额
- 平均单价
- 记录数

### 右侧 - 记录列表

#### 🔍 筛选功能
- **筛选日期** - 输入日期关键词筛选
- **筛选按钮** - 执行筛选
- **显示全部** - 显示所有记录
- **今天按钮** - 只看今天记录

#### 📋 记录表格
显示所有记录的详细信息：
- ID
- 日期
- 数量
- 单价
- 总金额
- 备注

#### 右键菜单
在表格上右键点击记录：
- 🗑️ **删除记录** - 删除选中的记录

### 底部工具栏

- **💾 导出CSV** - 导出数据到 Excel
- **📥 导入CSV** - 导入 Excel/CSV 数据
- **📊 月度统计** - 查看月度汇总报表
- **❌ 退出** - 关闭程序

## 💡 使用流程

### 日常记账
1. 运行程序，界面自动显示
2. 输入数量、单价（日期默认今天）
3. 可选输入备注（客户名、规格）
4. 按 **Enter** 或点击 **添加记录**
5. 记录立即显示在右侧列表中
6. 今日统计自动更新

### 查看记录
- 所有记录按日期倒序显示
- 使用筛选功能查找特定日期
- 点击"今天"快速查看当日记录

### 数据管理

#### 导出数据
1. 点击 **💾 导出CSV**
2. 选择保存位置
3. 用 Excel 打开查看

#### 导入旧数据（Excel）

**方法1：直接导入 Excel 文件（推荐）**

1. 点击 **📥 导入Excel**
2. 选择 Excel 文件（.xlsx 或 .xls）
3. 在弹出的预览窗口中：
   - 系统会自动识别日期、数量、单价列
   - 如果识别不正确，可手动选择对应列
   - 查看数据预览（前10行）
4. 点击 **确认导入**

**方法2：导入 CSV 文件**
1. 将 Excel 另存为 CSV 格式
2. 点击 **📥 导入CSV**
3. 选择 CSV 文件
4. 系统自动识别并导入

**⚠️ 注意：导入 Excel 需要先安装 openpyxl**
```bash
pip install openpyxl
```

#### 月度统计
1. 点击 **📊 月度统计**
2. 选择年份和月份
3. 查看月度汇总和每日明细

## 📊 数据存储

- **文件位置**：`C:\Users\用户名\.accounting-tool\records.json`
- **自动保存**：每次添加记录自动保存
- **备份建议**：定期导出 CSV 备份

## ⌨️ 快捷键

| 快捷键 | 功能 |
|--------|------|
| Enter | 添加记录 / 跳转到下一个输入框 |
| Ctrl + Enter | 在备注框中换行 |
| F5 | 刷新显示 |

### 快速录入操作流

**使用键盘快速录入（无需鼠标）：**

1. 程序启动后，光标自动在"数量"框
2. 输入数量，按 **Enter** → 跳到"单价"框
3. 输入单价，按 **Enter** → 跳到"备注"框
4. 输入备注（可选），按 **Enter** → 自动保存
5. 保存成功后，光标自动回到"数量"框，继续录入下一条

**需要多行备注？**
- 在备注框按 **Ctrl + Enter** 换行
- 或直接按 **Enter** 保存（如果不需要多行）

## 🔧 常见问题

### Q: 程序打不开
A: 确保已安装 Python 3.7+，双击 `记账系统-GUI.bat` 运行

### Q: 如何修改已录入的记录
A: 右键点击记录选择"删除"，然后重新录入

### Q: 数据保存在哪里
A: 自动保存在 `C:\Users\用户名\.accounting-tool\records.json`

### Q: 可以多人共用吗
A: 数据保存在本地电脑，建议每人使用自己的电脑

### Q: 如何备份数据
A: 点击"导出CSV"按钮，将数据导出保存

## 📝 CSV 导入格式

支持的列名：
- **日期**: 日期、date、Date
- **数量**: 数量、quantity、套数、套
- **单价**: 单价、price、unit_price、价格
- **备注**: 备注、note、Note（可选）

示例：
```csv
日期,数量,单价,备注
2026-02-06,5,280,客户A-蓝色
2026-02-06,3,320,客户B-粉色
```

## 🎨 界面预览

```
┌─────────────────────────────────────────────────┐
│  🏠 家纺四件套记账系统                    [_][X] │
├──────────────────────┬──────────────────────────┤
│  📝 录入新记录       │  📋 记录列表            │
│                      │                          │
│  📅 日期: [today]    │  [筛选: ______] [筛选]  │
│                      │                          │
│  📦 数量: [__]套     │  ┌──────────────────┐   │
│                      │  │ID 日期 数量 金额 │   │
│  💰 单价: [__]元     │  │1   今天  5   ¥1400│  │
│                      │  │2   今天  3   ¥960 │  │
│  💵 总金额: ¥0.00    │  └──────────────────┘   │
│                      │                          │
│  📝 备注: [      ]   │                          │
│                      │                          │
│  [✅ 添加记录]       │                          │
│  [🔄 清空表单]       │                          │
│                      │                          │
│  📊 今日统计         │                          │
│  总数量: 8套         │                          │
│  总金额: ¥2360       │                          │
│                      │                          │
└──────────────────────┴──────────────────────────┘
[💾 导出] [📥 导入] [📊 统计] [❌ 退出]
```

## 💪 祝生意兴隆！

如有问题，可以查看数据文件或重新运行程序。
