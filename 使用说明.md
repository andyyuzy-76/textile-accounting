# 🏠 家纺四件套记账工具使用说明

## 📦 文件说明

位置：`C:\Users\Administrator\.accounting-tool\

| 文件 | 说明 |
|------|------|
| **accounting.py** | 主程序 |
| **import_csv.py** | CSV 导入工具 |
| **记账工具.bat** | 双击运行启动 |
| **使用说明.md** | 本文档 |
| **records.json** | 数据存储文件（自动创建） |

## 🚀 快速开始

### 运行程序
```bash
# 方法1：双击运行
%USERPROFILE%\.accounting-tool\记账工具.bat

# 方法2：命令行
cd %USERPROFILE%\.accounting-tool
python accounting.py
```

## 📋 功能介绍

### 1️⃣ 添加记录
记录每日进货/销售情况：
- 日期（直接回车使用今天）
- 数量（套）
- 单价（元）
- 备注（可选，如客户名、货品规格）

**系统自动计算总金额**

### 2️⃣ 查询某日
查看某一天的详细记录和汇总统计

### 3️⃣ 查询日期范围
查看一段时间内的所有记录（如查一周、一个月）

### 4️⃣ 今日统计
快速查看今天的总数量和总金额

### 5️⃣ 月度统计
查看整月的汇总数据

### 6️⃣ 显示所有记录
列出所有历史记录（最多显示50条）

### 7️⃣ 删除记录
删除错误的记录

### 8️⃣ 导出 CSV
导出为 Excel 文件，方便打印或分析

### 9️⃣ 导入 Excel/CSV ⭐
**将以前的 Excel 记录导入系统**

#### 导入步骤：

1. **准备 Excel 文件**
   - 确保 Excel 有表头（列名）
   - 建议列名：日期、数量、单价、备注
   - 支持的中文列名：
     - 日期：日期、date、时间、Date
     - 数量：数量、quantity、套数、件数、套
     - 单价：单价、price、unit_price、价格
     - 备注：备注、note、说明、客户

2. **另存为 CSV 格式**
   - Excel → 文件 → 另存为
   - 选择"CSV (逗号分隔)(*.csv)"
   - 保存

3. **导入到记账工具**
   - 选择菜单 **9. 导入 Excel/CSV**
   - 输入 CSV 文件路径（可以直接拖入文件）
   - 系统自动识别列
   - 如有未识别的列，会提示手动指定
   - 确认导入

4. **完成**
   - 导入成功后即可在主程序中查看
   - 失败记录会保存到 `import_failed.log`

#### 支持的日期格式：
- `2026-02-06`
- `2026/02/06`
- `2026年02月06日`
- `2026.02.06`
- Excel 日期序列号

#### 示例 CSV 格式：
```csv
日期,数量,单价,备注
2026-01-15,5,280,客户A-蓝色
2026-01-16,3,320,客户B-粉色
2026-01-20,10,260,客户C-丝绸款
```

### 🔟 退出
关闭程序

## 💾 数据存储

- **文件位置**：`C:\Users\用户名\.accounting-tool\records.json`
- **格式**：JSON，易于备份
- **自动保存**：每次操作后自动保存
- **备份建议**：定期导出 CSV 备份

## 💡 使用技巧

### 日常记账
1. 每天结束营业后，添加当日记录
2. 可以一天添加多条记录（不同客户、不同规格）
3. 在备注中记录客户名称、货品规格等信息

### 数据查询
1. **今日统计**：快速查看当天经营状况
2. **月度统计**：月底查看整月汇总
3. **日期范围**：查一周、查一个月的销售情况

### 数据管理
1. **定期导出**：建议每周导出 CSV 备份
2. **导入旧数据**：将以前的 Excel 记录导入统一查询
3. **删除错误**：发现错误记录及时删除

## 📞 常见问题

### Q: 导入 CSV 时提示"列数不足"
A: 请检查 CSV 文件是否包含表头行，并且数据行与表头列数一致

### Q: 日期识别错误
A: 支持多种日期格式，如果识别失败，系统会提示手动输入

### Q: 导入后数据没显示
A: 检查 `import_failed.log` 文件，查看失败原因

### Q: 如何修改已导入的数据
A: 先删除原记录，再重新导入，或直接在主程序中添加

### Q: 数据文件在哪里
A: `%USERPROFILE%\.accounting-tool\records.json`

## 🔒 数据安全

- 数据保存在本地电脑
- JSON 格式，可用文本编辑器查看
- 可随时导出 CSV 备份
- 不上传到任何服务器

---

💪 **祝生意兴隆！**

如有问题，可以查看 `import_failed.log` 了解导入失败详情。
