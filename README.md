# 🏠 家纺四件套记账系统

简单易用的家纺销售记账工具，专为四件套销售设计。

## 功能特点

- ✅ **多商品录入** - 一次录入多个不同单价的商品
- 🔄 **退货管理** - 支持部分退货，关联原购买记录
- 📊 **树形显示** - 购买和退货记录父子关系一目了然
- 📈 **统计分析** - 日/月/年度销售统计
- 📥 **数据导入导出** - 支持CSV和Excel格式
- 🧾 **小票打印** - 支持58mm热敏打印机，可预览和打印
- 🔄 **自动升级** - 检测新版本一键更新

## 安装使用

### 方式一：直接运行Python脚本

```bash
# 需要Python 3.6+
python accounting_gui.py
```

### 方式二：下载打包版本

从 [Releases](https://github.com/andyyuzy-76/textile-accounting/releases) 下载最新版本的exe文件。

## 快捷键

- `Ctrl+Enter` - 提交记录
- `F5` - 刷新显示
- 右键菜单 - 编辑/退货/删除/打印

## 小票打印

### 打印设置
点击底部工具栏的「🖨️ 打印设置」按钮，可以设置：

**打印机设置：**
- 🖨️ **选择打印机** - 选择系统已安装的打印机（或使用默认打印机）
- 📏 **纸张宽度** - 支持58mm和80mm两种宽度
- ⚡ **自动打印** - 开启后销售/退货成功后自动打印小票

**店铺信息：**
- 店铺名称、地址、电话
- 小票底部自定义文字

**实时预览：**
- 预览按钮可实时查看小票效果
- 根据纸张宽度自动调整排版

### 如何打印
1. **销售/退货后打印** - 添加记录成功后，点击「🖨️ 打印小票」按钮
2. **历史记录打印** - 在记录列表中右键点击记录，选择「🖨️ 打印小票」
3. **预览模式** - 可以先预览小票，确认无误后再打印或保存

### 支持打印机
- ✅ Windows系统打印机（USB/网络/蓝牙）
- ✅ 58mm/80mm热敏小票打印机
- ✅ 普通喷墨/激光打印机（A4纸打印）
- ✅ 支持打印预览
- ✅ 支持保存为文本文件

### 设置保存
- 所有设置自动保存到 `printer_settings.json`
- 设置将在下次启动时自动加载
- 数据目录：`C:\Users\用户名\.accounting-tool\`

## 数据存储

数据保存在用户目录下：
- Windows: `C:\Users\用户名\.accounting-tool\records.json`

## 版本历史

### v0.3
- ✨ 新增软件内自动更新功能
  - 一键下载并自动安装新版本
  - 支持进度显示
  - 自动备份旧版本
  - 自动重启到新版本
- 🔄 改进更新检测机制
  - 自动识别EXE文件
  - 显示自动更新按钮（仅EXE版本）

### v0.2
- ✨ 新增小票打印功能
  - 支持58mm热敏打印机
  - 支持打印预览
  - 自定义店铺信息
  - 销售/退货后可直接打印
- 📝 右键菜单新增"打印小票"选项

### v0.1
- 初始版本
- 多商品录入
- 部分退货功能
- 树形显示购买和退货关系
- 系统设置和升级检查

## 开源协议

MIT License
